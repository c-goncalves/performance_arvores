#include <stdio.h>
#include <stdlib.h>
#include "tree_performance.h"


// Insere no inicio da lista
int *lerArquivo(){
    FILE *file;
    file = fopen("massaDados.csv", "r");
    if(file == NULL){
        printf("Erro na leitura");
        return;
    }
    // Numero de linhas do arquivo
    int count = 1;
    char c; 
    for (c = getc(file); c != EOF; c = getc(file))
        if (c == '\n')
            count = count + 1;

    fclose(file);
    file = fopen("massaDados.csv", "r");

    // Inserindo dados do 
    int read =0, records=0;
    FUNCIONARIO *dados = (FUNCIONARIO*)malloc(count*sizeof(FUNCIONARIO));
    int x =1;
    do{
        read = fscanf(file,
                        "%d,%29[^,],%d,%14[^,],%29[^,],%lf\n",
                        &dados[records].p,
                        dados[records].nome,
                        &dados[records].idade,
                        dados[records].empresa,
                        dados[records].departamento,
                        &dados[records].salario
                        );
        printf("%d, ", x);
        x++;
        if(read == 6) records++;
        if(read !=6 && !feof(file)){
            printf("file format incorrect\n");
            return;
        }


    }while(x<=count);

    fclose(file);

    return dados;
}


